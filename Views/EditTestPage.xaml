<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="EducationalPlatform.Views.EditTestPage"
             Title="Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð°">

    <ScrollView>
        <VerticalStackLayout Spacing="20" Padding="20">

            <Label Text="Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð°" 
                   FontSize="24" FontAttributes="Bold"
                   HorizontalOptions="Center" />

            <Border Style="{DynamicResource StandardFrameStyle}" Padding="15">
                <VerticalStackLayout Spacing="15">

                    <Label Text="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð°:" Style="{DynamicResource StandardLabelStyle}"/>
                    <Entry Text="{Binding TestTitle}" Placeholder="Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð°" />

                    <Label Text="ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ:" Style="{DynamicResource StandardLabelStyle}"/>
                    <Editor Text="{Binding TestDescription}" HeightRequest="80" />

                    <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                        <VerticalStackLayout Spacing="10">
                            <Label Text="Ð›Ð¸Ð¼Ð¸Ñ‚ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ (Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹):" Style="{DynamicResource StandardLabelStyle}"/>
                            <Entry Text="{Binding TimeLimit}" Keyboard="Numeric" />
                        </VerticalStackLayout>

                        <VerticalStackLayout Spacing="10">
                            <Label Text="ÐŸÑ€Ð¾Ñ…Ð¾Ð´Ð½Ð¾Ð¹ Ð±Ð°Ð»Ð»:" Style="{DynamicResource StandardLabelStyle}"/>
                            <Entry Text="{Binding PassingScore}" Keyboard="Numeric" />
                        </VerticalStackLayout>
                    </Grid>

                    <!-- Ð¡ÐµÐºÑ†Ð¸Ñ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð² -->
                    <Frame BackgroundColor="#F8F9FA" Padding="15">
                        <VerticalStackLayout Spacing="10">
                            <Label Text="Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ñ‚ÐµÑÑ‚Ð°:" 
                                   FontSize="16" 
                                   FontAttributes="Bold"
                                   TextColor="{DynamicResource PrimaryColor}" />

                            <CollectionView ItemsSource="{Binding Questions}" HeightRequest="200">
                                <CollectionView.ItemTemplate>
                                    <DataTemplate>
                                        <Frame BackgroundColor="White" Padding="10" Margin="0,5">
                                            <VerticalStackLayout Spacing="5">
                                                <Label Text="{Binding QuestionText}" 
                                                       FontSize="14" 
                                                       FontAttributes="Bold" />
                                                <Label Text="{Binding QuestionType, StringFormat='Ð¢Ð¸Ð¿: {0}'}" 
                                                       FontSize="12" 
                                                       TextColor="Gray" />
                                                <Label Text="{Binding Score, StringFormat='Ð‘Ð°Ð»Ð»Ñ‹: {0}'}" 
                                                       FontSize="12" 
                                                       TextColor="Gray" />
                                                <Grid ColumnDefinitions="*,*" ColumnSpacing="5">
                                                    <Button Text="âœï¸ Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ" 
                                                            Clicked="OnEditQuestionClicked"
                                                            CommandParameter="{Binding .}" />
                                                    <Button Text="ðŸ—‘ï¸ Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ" 
                                                            Clicked="OnDeleteQuestionClicked"
                                                            CommandParameter="{Binding .}"
                                                            BackgroundColor="Red"
                                                            Grid.Column="1" />
                                                </Grid>
                                            </VerticalStackLayout>
                                        </Frame>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                            </CollectionView>

                            <Button Text="âž• Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð²Ð¾Ð¿Ñ€Ð¾Ñ" 
                                    Clicked="OnAddQuestionClicked"
                                    BackgroundColor="{DynamicResource SecondaryColor}"
                                    TextColor="White" />
                        </VerticalStackLayout>
                    </Frame>

                    <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                        <Button Text="ÐÐ°Ð·Ð°Ð´" Clicked="OnBackClicked" />
                        <Button Text="Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ" Clicked="OnSaveClicked" 
                                BackgroundColor="{DynamicResource PrimaryColor}" />
                    </Grid>

                </VerticalStackLayout>
            </Border>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>