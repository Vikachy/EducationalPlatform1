<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="EducationalPlatform.Views.EditTestPage"
             Title="Редактирование теста">

    <ScrollView>
        <VerticalStackLayout Spacing="20" Padding="20">

            <Label Text="Редактирование теста" 
                   FontSize="24" FontAttributes="Bold"
                   HorizontalOptions="Center" />

            <Border Style="{DynamicResource StandardFrameStyle}" Padding="15">
                <VerticalStackLayout Spacing="20">
                    <!-- Увеличил spacing -->

                    <Label Text="Название теста:" Style="{DynamicResource StandardLabelStyle}"/>
                    <Entry Text="{Binding TestTitle}" Placeholder="Введите название теста" />

                    <Label Text="Описание:" Style="{DynamicResource StandardLabelStyle}"/>
                    <Editor Text="{Binding TestDescription}" HeightRequest="80" />

                    <!-- ИСПРАВЛЕННАЯ СЕТКА С БОЛЬШИМ РАССТОЯНИЕМ -->
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="20" RowSpacing="15">
                        <VerticalStackLayout Grid.Column="0" Spacing="8">
                            <Label Text="Лимит времени (минуты):" 
                                   Style="{DynamicResource StandardLabelStyle}"/>
                            <Entry Text="{Binding TimeLimit}" 
                                   Keyboard="Numeric" 
                                   BackgroundColor="White"
                                   HeightRequest="50"/>
                        </VerticalStackLayout>

                        <VerticalStackLayout Grid.Column="1" Spacing="8">
                            <Label Text="Проходной балл:" 
                                   Style="{DynamicResource StandardLabelStyle}"/>
                            <Entry Text="{Binding PassingScore}" 
                                   Keyboard="Numeric" 
                                   BackgroundColor="White"
                                   HeightRequest="50"/>
                        </VerticalStackLayout>
                    </Grid>

                    <!-- Секция вопросов -->
                    <Frame BackgroundColor="#F8F9FA" Padding="15" Margin="0,10">
                        <VerticalStackLayout Spacing="15">
                            <Label Text="Вопросы теста:" 
                                   FontSize="16" 
                                   FontAttributes="Bold"
                                   TextColor="{DynamicResource PrimaryColor}" />

                            <CollectionView ItemsSource="{Binding Questions}" 
                                          HeightRequest="250"
                                          Margin="0,10">
                                <CollectionView.ItemTemplate>
                                    <DataTemplate>
                                        <Frame BackgroundColor="White" 
                                               Padding="15" 
                                               Margin="0,5"
                                               BorderColor="#DDD">
                                            <VerticalStackLayout Spacing="8">
                                                <Label Text="{Binding QuestionText}" 
                                                       FontSize="14" 
                                                       FontAttributes="Bold"
                                                       LineBreakMode="WordWrap" />
                                                <Label Text="{Binding QuestionType, StringFormat='Тип: {0}'}" 
                                                       FontSize="12" 
                                                       TextColor="Gray" />
                                                <Label Text="{Binding Score, StringFormat='Баллы: {0}'}" 
                                                   FontSize="12" 
                                                   TextColor="Gray" />
                                                <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                                                    <Button Text="Редактировать" 
                                                            Clicked="OnEditQuestionClicked"
                                                            CommandParameter="{Binding .}"
                                                            BackgroundColor="{DynamicResource PrimaryColor}"
                                                            TextColor="White"
                                                            HeightRequest="40"/>
                                                    <Button Text="Удалить" 
                                                            Clicked="OnDeleteQuestionClicked"
                                                            CommandParameter="{Binding .}"
                                                            BackgroundColor="Red"
                                                            TextColor="White"
                                                            HeightRequest="40"
                                                            Grid.Column="1" />
                                                </Grid>
                                            </VerticalStackLayout>
                                        </Frame>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                            </CollectionView>

                            <Button Text="➕ Добавить вопрос" 
                                    Clicked="OnAddQuestionClicked"
                                    BackgroundColor="{DynamicResource SecondaryColor}"
                                    TextColor="White"
                                    HeightRequest="50"
                                    CornerRadius="10" />
                        </VerticalStackLayout>
                    </Frame>

                    <Grid ColumnDefinitions="*,*" ColumnSpacing="15" Margin="0,10">
                        <Button Text="Назад" 
                                Clicked="OnBackClicked"
                                BackgroundColor="Gray"
                                TextColor="White"
                                HeightRequest="50" />
                        <Button Text="Сохранить изменения" 
                                Clicked="OnSaveClicked" 
                                BackgroundColor="{DynamicResource PrimaryColor}"
                                TextColor="White"
                                HeightRequest="50" />
                    </Grid>

                </VerticalStackLayout>
            </Border>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>