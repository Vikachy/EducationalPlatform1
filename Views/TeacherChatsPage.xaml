<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="EducationalPlatform.Views.TeacherChatsPage"
             Title="Ð§Ð°Ñ‚Ñ‹ Ð¿Ñ€ÐµÐ¿Ð¾Ð´Ð°Ð²Ð°Ñ‚ÐµÐ»Ñ">

    <Grid RowDefinitions="Auto,*">
        <!-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº -->
        <Border Grid.Row="0" BackgroundColor="#2E86AB" Padding="15">
            <Grid ColumnDefinitions="*,Auto" VerticalOptions="Center">
                <Label Grid.Column="0" Text="ðŸ’¬ Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ‡Ð°Ñ‚Ð°Ð¼Ð¸ Ð³Ñ€ÑƒÐ¿Ð¿" FontSize="18" FontAttributes="Bold" TextColor="White" />
                <Button Grid.Column="1" Text="ðŸ‘¥ Ð“Ñ€ÑƒÐ¿Ð¿Ñ‹" BackgroundColor="White" TextColor="#2E86AB" CornerRadius="8" Padding="10,6" Clicked="OnManageGroupsClicked" />
            </Grid>
        </Border>

        <!-- Ð”Ð²Ðµ ÐºÐ¾Ð»Ð¾Ð½ÐºÐ¸: ÑÐ»ÐµÐ²Ð° ÑÐ¿Ð¸ÑÐ¾Ðº Ñ‡Ð°Ñ‚Ð¾Ð², ÑÐ¿Ñ€Ð°Ð²Ð° Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ Ñ‡Ð°Ñ‚ -->
        <Grid Grid.Row="1" ColumnDefinitions="300,*">
            <!-- Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð³Ñ€ÑƒÐ¿Ð¿ ÑÐ»ÐµÐ²Ð° -->
            <CollectionView Grid.Column="0" 
                            x:Name="GroupsCollectionView"
                            ItemsSource="{Binding Groups}"
                            SelectionMode="Single"
                            SelectionChanged="OnGroupSelected">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border Margin="10,5" 
                                BackgroundColor="White" 
                                Stroke="#E0E0E0" 
                                StrokeThickness="1" 
                                StrokeShape="RoundRectangle 10" 
                                Padding="15">
                            <Grid ColumnDefinitions="Auto,*,Auto" VerticalOptions="Center">
                                <Label Grid.Column="0" Text="ðŸ‘¥" FontSize="24" VerticalOptions="Center" Margin="0,0,10,0" />
                                <VerticalStackLayout Grid.Column="1" Spacing="5">
                                    <Label Text="{Binding GroupName}" FontSize="16" FontAttributes="Bold" />
                                    <Label Text="{Binding CourseName}" FontSize="12" TextColor="#666" />
                                    <Label Text="{Binding StudentCount, StringFormat='Ð¡Ñ‚ÑƒÐ´ÐµÐ½Ñ‚Ð¾Ð²: {0}'}" FontSize="10" TextColor="#999" />
                                    <Label Text="{Binding IsActive, Converter={StaticResource StatusConverter}}" FontSize="10" TextColor="{Binding IsActive, Converter={StaticResource StatusColorConverter}}" />
                                </VerticalStackLayout>
                                <Button Grid.Column="2" Text="ðŸ’¬" BackgroundColor="#2E86AB" TextColor="White" WidthRequest="40" HeightRequest="40" CornerRadius="20" />
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <!-- ÐŸÑ€Ð°Ð²Ð°Ñ Ð¿Ð°Ð½ÐµÐ»ÑŒ: Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ Ñ‡Ð°Ñ‚ ÐºÐ°Ðº Ð² Telegram -->
            <Grid Grid.Column="1" RowDefinitions="Auto,*,Auto">
                <!-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº Ñ‡Ð°Ñ‚Ð° -->
                <Border Grid.Row="0" BackgroundColor="#2E86AB" Padding="15">
                    <VerticalStackLayout>
                        <Label x:Name="ChatGroupNameLabel" Text="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ‡Ð°Ñ‚" FontSize="18" FontAttributes="Bold" TextColor="White" HorizontalOptions="Center" />
                        <Label x:Name="ChatOnlineLabel" Text="ÐžÐ½Ð»Ð°Ð¹Ð½: 0" FontSize="12" TextColor="White" HorizontalOptions="Center" />
                    </VerticalStackLayout>
                </Border>

                <!-- Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ -->
                <CollectionView Grid.Row="1"
                                x:Name="MessagesCollectionView"
                                ItemsSource="{Binding Messages}"
                                SelectionMode="None">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Border Padding="10" Margin="5" StrokeThickness="0" StrokeShape="RoundRectangle 15">
                                <VerticalStackLayout Spacing="5">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <Label Grid.Column="0" Text="{Binding SenderName}" FontSize="12" FontAttributes="Bold" />
                                        <Label Grid.Column="1" Text="{Binding SentDate, StringFormat='{0:HH:mm}'}" FontSize="10" />
                                    </Grid>
                                    <Label Text="{Binding MessageText}" FontSize="14" LineBreakMode="WordWrap" />
                                </VerticalStackLayout>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

                <!-- Ð’Ð²Ð¾Ð´ -->
                <Border Grid.Row="2" BackgroundColor="White" Stroke="#E0E0E0" StrokeThickness="1" Padding="10">
                    <Grid ColumnDefinitions="*,Auto,Auto" ColumnSpacing="10">
                        <Entry Grid.Column="0" x:Name="MessageEntry" Placeholder="Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ..." Completed="OnMessageSent" ReturnType="Send" />
                        <Button Grid.Column="1" Text="ðŸ“Ž" BackgroundColor="Transparent" TextColor="#2E86AB" WidthRequest="40" HeightRequest="40" Clicked="OnAttachFileClicked" />
                        <Button Grid.Column="2" Text="âž¤" BackgroundColor="#2E86AB" TextColor="White" WidthRequest="40" HeightRequest="40" Clicked="OnSendMessageClicked" />
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </Grid>

</ContentPage>



