<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="EducationalPlatform.Views.TeacherGroupsPage"
             Title="Ð£Ñ‡ÐµÐ±Ð½Ñ‹Ðµ Ð³Ñ€ÑƒÐ¿Ð¿Ñ‹">

    <Grid RowDefinitions="Auto,*,Auto">
        <Border Grid.Row="0" BackgroundColor="{DynamicResource PrimaryColor}" Padding="15">
            <HorizontalStackLayout>
                <Button Text="â†" Clicked="OnBackClicked" BackgroundColor="Transparent" TextColor="White" />
                <Label Text="Ð“Ñ€ÑƒÐ¿Ð¿Ñ‹" FontSize="20" TextColor="White" FontAttributes="Bold" />
            </HorizontalStackLayout>
        </Border>

        <CollectionView Grid.Row="1" x:Name="GroupsCollection" SelectionMode="Single" SelectionChanged="OnGroupSelected">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Border Margin="10" Padding="12" BackgroundColor="#F8F9FA" Stroke="#DDD" StrokeThickness="1" StrokeShape="RoundRectangle 10">
                        <Grid ColumnDefinitions="*,Auto,Auto" RowDefinitions="Auto,Auto">
                            <Label Grid.Column="0" Grid.Row="0" Text="{Binding GroupName}" FontAttributes="Bold" />
                            <Label Grid.Column="0" Grid.Row="1" Text="{Binding StudentCount, StringFormat='Ð¡Ñ‚ÑƒÐ´ÐµÐ½Ñ‚Ð¾Ð²: {0}'}" FontSize="12" TextColor="#666" />
                            <Button Grid.Column="1" Grid.RowSpan="2" Text="Ð§Ð°Ñ‚" Clicked="OnOpenChatClicked" CommandParameter="{Binding .}" />
                            <Button Grid.Column="2" Grid.RowSpan="2" Text="Ð”ÐµÐ°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ" Clicked="OnDeactivateGroupClicked" CommandParameter="{Binding .}" />
                        </Grid>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <Grid Grid.Row="2" RowDefinitions="Auto,Auto" ColumnDefinitions="*" Padding="12">
            <Border Padding="12" BackgroundColor="{DynamicResource CardColor}">
                <Grid ColumnDefinitions="*,*,Auto" ColumnSpacing="8">
                    <Entry x:Name="GroupNameEntry" Placeholder="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð³Ñ€ÑƒÐ¿Ð¿Ñ‹" />
                    <Picker x:Name="CoursePicker" Title="ÐšÑƒÑ€Ñ" ItemDisplayBinding="{Binding CourseName}" />
                    <Button Text="Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ" Clicked="OnCreateGroupClicked" BackgroundColor="{DynamicResource PrimaryColor}" TextColor="White" />
                </Grid>
            </Border>
            <Border Grid.Row="1" Padding="12" BackgroundColor="#F8F9FA" Stroke="#DDD" StrokeThickness="1" StrokeShape="RoundRectangle 10" Margin="0,8,0,0">
                <VerticalStackLayout>
                    <Label Text="Ð¡Ð¾ÑÑ‚Ð°Ð² Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ð¾Ð¹ Ð³Ñ€ÑƒÐ¿Ð¿Ñ‹" FontAttributes="Bold" />
                    <CollectionView x:Name="GroupStudentsCollection" SelectionMode="None">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid ColumnDefinitions="Auto,*,Auto" Padding="6">
                                    <Label Text="ðŸ‘¤" />
                                    <Label Grid.Column="1" Text="{Binding Username}" />
                                    <Button Grid.Column="2" Text="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ" Clicked="OnRemoveStudentClicked" CommandParameter="{Binding .}" />
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="8" Margin="0,6,0,0">
                        <Entry x:Name="StudentUsernameEntry" Placeholder="Ð˜Ð¼Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ" />
                        <Button Text="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ" Clicked="OnAddStudentClicked" />
                    </Grid>
                </VerticalStackLayout>
            </Border>
        </Grid>
    </Grid>
</ContentPage>